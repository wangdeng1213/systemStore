!function(b){function a(c,d){this.options=this.getOptions(d);this.select=b(c);this.container=b(this.options.container).append('<button type="button" style="width:'+this.options.width+'" class="dropdown-toggle '+this.options.button+'" data-toggle="dropdown">'+this.options.text(b("option:selected",c))+' <b class="caret"></b></button>').append('<ul class="dropdown-menu"></ul>');if(!this.select.attr("multiple")){this.select.attr("multiple",true)}b("option",this.select).each(b.proxy(function(e,f){if(b(f).is(":selected")){b(f).attr("selected",true)}b("ul",this.container).append('<li><a href="#" style="padding:0;"><label style="margin:0;padding: 3px 20px 3px 20px;width:100%;height:100%;cursor:pointer;"><input style="margin-bottom:5px;" type="checkbox" value="'+b(f).val()+'" /> '+b(f).text()+"</label</a></li>");var g=b(f).attr("selected")||false;var h=b('ul li input[value="'+b(f).val()+'"]',this.container);h.prop("checked",g);if(g){h.parents("li").addClass("active")}},this));this.select.hide().after(this.container);b('ul li input[type="checkbox"]',this.container).on("change",b.proxy(function(h){var g=b(h.target).prop("checked")||false;if(g){b(h.target).parents("li").addClass("active")}else{b(h.target).parents("li").removeClass("active")}var f=b('option[value="'+b(h.target).val()+'"]',this.select);f.attr("selected",g);var e=b("option:selected",this.select);b("button",this.container).html(this.options.text(e)+' <b class="caret"></b>');this.options.onchange(f,g)},this));b("ul li a",this.container).on("click",function(e){e.stopPropagation()})}a.prototype={defaults:{button:"btn",width:"auto",text:function(c){if(c.length==0){return"None selected"}else{if(c.length>3){return c.length+" selected"}else{var d="";c.each(function(){d+=b(this).text()+", "});return d.substr(0,d.length-2)}}},container:'<div class="btn-group" />',onchange:function(){}},constructor:a,reset:function(){},destroy:function(){this.container.remove();this.select.show()},refresh:function(){b("option",this.select).each(b.proxy(function(c,d){if(b(d).is(":selected")){b('ul li input[value="'+b(d).val()+'"]',this.container).prop("checked",true)}else{b('ul li input[value="'+b(d).val()+'"]',this.container).prop("checked",false)}},this));b("button",this.container).html(this.options.text(b("option:selected",this.select))+' <b class="caret"></b>')},getOptions:function(c){return b.extend({},this.defaults,c)}};b.fn.multiselect=function(c){return this.each(function(){var e=b(this).data("multiselect"),d=typeof c=="object"&&c;if(!e){b(this).data("multiselect",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})}}(window.jQuery);